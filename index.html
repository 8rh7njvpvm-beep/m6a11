<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¯”ä¾‹åµæ¢äº‹å‹™æ‰€ - å°‹æ‰¾æ•¸å­¸çœŸç›¸</title>
    <style>
        :root {
            --bg-color: #2c3e50;
            --card-bg: #ecf0f1;
            --accent: #e74c3c;
            --text: #2c3e50;
            --correct: #27ae60;
            --wrong: #c0392b;
        }

        body {
            font-family: 'Courier New', Courier, monospace; /* åµæ¢æ‰“å­—æ©Ÿé¢¨æ ¼ */
            background-color: var(--bg-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            color: var(--text);
        }

        .game-container {
            background-color: var(--card-bg);
            width: 90%;
            max-width: 600px;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
            border-left: 10px solid var(--accent);
            position: relative;
        }

        h1 {
            text-align: center;
            border-bottom: 2px dashed var(--text);
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        .detective-icon {
            font-size: 3rem;
            display: block;
            text-align: center;
            margin-bottom: 10px;
        }

        .status-bar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            font-weight: bold;
            color: #7f8c8d;
        }

        .case-file {
            background: #fff;
            padding: 20px;
            border: 1px solid #bdc3c7;
            margin-bottom: 20px;
            position: relative;
        }

        .case-file::before {
            content: "æ©Ÿå¯†æª”æ¡ˆ";
            position: absolute;
            top: -10px;
            left: 10px;
            background: var(--accent);
            color: white;
            padding: 2px 8px;
            font-size: 0.8rem;
            transform: rotate(-2deg);
        }

        .question-text {
            font-size: 1.2rem;
            margin: 15px 0;
            line-height: 1.6;
        }

        .btn-group {
            display: flex;
            gap: 10px;
        }

        button {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.3s;
            font-family: inherit;
        }

        .btn-yes {
            background-color: #3498db;
            color: white;
        }

        .btn-no {
            background-color: #e67e22;
            color: white;
        }

        button:hover {
            transform: translateY(-2px);
            opacity: 0.9;
        }

        button:disabled {
            background-color: #95a5a6;
            cursor: not-allowed;
            transform: none;
        }

        /* Feedback Modal/Area */
        .feedback-area {
            display: none;
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            animation: fadeIn 0.5s;
        }

        .feedback-correct {
            background-color: #d4edda;
            border-left: 5px solid var(--correct);
            color: #155724;
        }

        .feedback-wrong {
            background-color: #f8d7da;
            border-left: 5px solid var(--wrong);
            color: #721c24;
        }

        .next-btn {
            background-color: var(--text);
            color: white;
            width: 100%;
            margin-top: 15px;
            display: none;
        }

        .result-screen {
            display: none;
            text-align: center;
        }

        .hidden {
            display: none;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

    </style>
</head>
<body>

    <div class="game-container" id="game-container">
        <div id="start-screen">
            <span class="detective-icon">ğŸ•µï¸â€â™‚ï¸</span>
            <h1>æ¯”ä¾‹åµæ¢äº‹å‹™æ‰€</h1>
            <p>æ­¡è¿ä¾†åˆ°åµæ¢ç‰¹è¨“ç­ï¼</p>
            <p>æˆ‘å€‘æœƒéš¨æ©Ÿå¾è³‡æ–™åº«ä¸­èª¿é–± <strong>5 ä»½æª”æ¡ˆ</strong>ã€‚</p>
            <p>ä½ çš„ä»»å‹™æ˜¯åˆ¤æ–·ç¾å ´ç•™ä¸‹çš„å…©å€‹æ¯”ï¼Œæ˜¯å¦æŒ‡å‘åŒä¸€å€‹çœŸç›¸ï¼ˆæ˜¯å¦æˆæ¯”ä¾‹ï¼‰ã€‚</p>
            <button onclick="startGame()" style="background-color: var(--accent); color: white;">æ¥å—ä»»å‹™</button>
        </div>

        <div id="quiz-screen" class="hidden">
            <div class="status-bar">
                <span id="progress">æ¡ˆä»¶ï¼š1 / 5</span>
                <span id="score-display">åµæ¢ç©åˆ†ï¼š0</span>
            </div>

            <div class="case-file">
                <p><strong>è­‰æ“šæ¯”å°ï¼š</strong></p>
                <div class="question-text" id="question-content">
                    è¼‰å…¥ä¸­...
                </div>
            </div>

            <div class="btn-group" id="options-area">
                <button class="btn-yes" onclick="checkAnswer(true)">æ˜¯ï¼Œèƒ½çµ„æˆæ¯”ä¾‹</button>
                <button class="btn-no" onclick="checkAnswer(false)">å¦ï¼Œä¸èƒ½çµ„æˆæ¯”ä¾‹</button>
            </div>

            <div id="feedback" class="feedback-area"></div>
            <button id="next-btn" class="next-btn" onclick="nextQuestion()">èª¿æŸ¥ä¸‹ä¸€å€‹æ¡ˆä»¶</button>
        </div>

        <div id="result-screen" class="result-screen hidden">
            <span class="detective-icon">ğŸ†</span>
            <h1>çµæ¡ˆå ±å‘Š</h1>
            <p id="final-message"></p>
            <p style="font-size: 2rem; font-weight: bold;" id="final-score"></p>
            <button onclick="location.reload()" style="background-color: var(--accent); color: white;">é‡æ–°ç‰¹è¨“</button>
        </div>
    </div>

    <script>
        // éŠæˆ²ç‹€æ…‹
        let currentQuestionIndex = 0;
        let score = 0;
        const totalQuestions = 5;
        let questions = [];
        let currentQuestion = null;

        // éš¨æ©Ÿæ•¸ç”Ÿæˆå™¨ (min åˆ° maxï¼ŒåŒ…å« min å’Œ max)
        function getRandomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        // é¡Œç›®ç”Ÿæˆå·¥å»  (æ¨¡æ“¬100+é¡Œåº«)
        function generateQuestions(count) {
            const tempQuestions = [];
            
            for (let i = 0; i < count; i++) {
                // æ±ºå®šé€™ä¸€é¡Œæ˜¯å¦æˆæ¯”ä¾‹ (50% æ©Ÿç‡)
                const isProportion = Math.random() < 0.5;
                
                // åŸºç¤æ•¸å­—ç”Ÿæˆ
                let a = getRandomInt(1, 12);
                let b = getRandomInt(2, 20);
                
                // é¿å… a=b (1:1) éæ–¼ç°¡å–®ï¼Œé›–ç„¶ä¹Ÿæ˜¯åˆæ³•çš„
                if(a === b) b++;

                // å€æ•¸ (æ“´åˆ†ç”¨)
                let scale = getRandomInt(2, 6);
                
                let c, d;

                if (isProportion) {
                    // æˆæ¯”ä¾‹ï¼šç›´æ¥æ“´åˆ†
                    c = a * scale;
                    d = b * scale;
                } else {
                    // ä¸æˆæ¯”ä¾‹ï¼šè£½é€ å¹²æ“¾é …
                    c = a * scale;
                    // d æ•…æ„åšéŒ¯ä¸€é»é» (ä¾‹å¦‚ +1 æˆ– -1ï¼Œæˆ–è€…ç”¨éŒ¯èª¤çš„å€æ•¸)
                    let error = (Math.random() < 0.5) ? 1 : -1;
                    d = (b * scale) + error; 
                    
                    // äºŒæ¬¡ç¢ºèªé¿å…å·§åˆ (æ¥µå°æ©Ÿç‡)
                    if (a * d === b * c) d += 1;
                }

                // éš¨æ©Ÿæ±ºå®šé¡¯ç¤ºæ ¼å¼ (ç›®å‰çµ±ä¸€ç‚º A:B å’Œ C:Dï¼Œå¯æ“´å±•ç‚ºåˆ†æ•¸å½¢å¼)
                const qText = `ç¬¬ä¸€çµ„ç·šç´¢ ${a} : ${b} <br> ç¬¬äºŒçµ„ç·šç´¢ ${c} : ${d}`;

                // è¨ˆç®—è©³è§£
                const outerProduct = a * d; // å¤–é …ç©
                const innerProduct = b * c; // å…§é …ç©
                
                let explanation = "";
                if (isProportion) {
                    explanation = `é€™æ˜¯ä¸€å€‹æ¯”ä¾‹ï¼<br>
                    <strong>æª¢é©—æ–¹æ³•ï¼š</strong>å…§é …ç© = å¤–é …ç©ã€‚<br>
                    å…§é …ç›¸ä¹˜ï¼š${b} Ã— ${c} = ${innerProduct}<br>
                    å¤–é …ç›¸ä¹˜ï¼š${a} Ã— ${d} = ${outerProduct}<br>
                    å…©è€…ç›¸ç­‰ï¼Œæ¡ˆä»¶æˆç«‹ï¼`;
                } else {
                    explanation = `é€™ä¸æ˜¯æ¯”ä¾‹ï¼<br>
                    <strong>æª¢é©—æ–¹æ³•ï¼š</strong>å…§é …ç© â‰  å¤–é …ç©ã€‚<br>
                    å…§é …ç›¸ä¹˜ï¼š${b} Ã— ${c} = ${innerProduct}<br>
                    å¤–é …ç›¸ä¹˜ï¼š${a} Ã— ${d} = ${outerProduct}<br>
                    å…©è€…ä¸ç›¸ç­‰ï¼Œé€™æ˜¯å½è­‰ï¼`;
                }

                tempQuestions.push({
                    text: qText,
                    isCorrectYes: isProportion,
                    explanation: explanation
                });
            }
            return tempQuestions;
        }

        // é–‹å§‹éŠæˆ²
        function startGame() {
            questions = generateQuestions(totalQuestions);
            currentQuestionIndex = 0;
            score = 0;
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('quiz-screen').classList.remove('hidden');
            document.getElementById('score-display').innerText = `åµæ¢ç©åˆ†ï¼š${score}`;
            loadQuestion();
        }

        // è¼‰å…¥é¡Œç›®
        function loadQuestion() {
            currentQuestion = questions[currentQuestionIndex];
            document.getElementById('progress').innerText = `æ¡ˆä»¶ï¼š${currentQuestionIndex + 1} / ${totalQuestions}`;
            document.getElementById('question-content').innerHTML = currentQuestion.text;
            
            // é‡ç½®ä»‹é¢
            document.getElementById('feedback').style.display = 'none';
            document.getElementById('feedback').className = 'feedback-area';
            document.getElementById('next-btn').style.display = 'none';
            document.getElementById('options-area').querySelectorAll('button').forEach(btn => {
                btn.disabled = false;
            });
        }

        // æª¢æŸ¥ç­”æ¡ˆ
        function checkAnswer(userAnswerIsYes) {
            // é–å®šæŒ‰éˆ•
            document.getElementById('options-area').querySelectorAll('button').forEach(btn => {
                btn.disabled = true;
            });

            const feedbackEl = document.getElementById('feedback');
            const isCorrect = (userAnswerIsYes === currentQuestion.isCorrectYes);

            feedbackEl.style.display = 'block';

            if (isCorrect) {
                score += 20; // æ¯é¡Œ20åˆ†
                feedbackEl.innerHTML = `<strong>âœ… æ¨ç†æ­£ç¢ºï¼</strong><hr>${currentQuestion.explanation}`;
                feedbackEl.classList.add('feedback-correct');
            } else {
                feedbackEl.innerHTML = `<strong>âŒ æ¨ç†éŒ¯èª¤ï¼</strong><hr>${currentQuestion.explanation}`;
                feedbackEl.classList.add('feedback-wrong');
            }

            document.getElementById('score-display').innerText = `åµæ¢ç©åˆ†ï¼š${score}`;
            document.getElementById('next-btn').style.display = 'block';

            // å¦‚æœæ˜¯æœ€å¾Œä¸€é¡Œï¼ŒæŒ‰éˆ•æ–‡å­—æ”¹ç‚ºæŸ¥çœ‹çµæœ
            if (currentQuestionIndex === totalQuestions - 1) {
                document.getElementById('next-btn').innerText = "æŸ¥çœ‹ç‰¹è¨“çµæœ";
            } else {
                document.getElementById('next-btn').innerText = "èª¿æŸ¥ä¸‹ä¸€å€‹æ¡ˆä»¶";
            }
        }

        // ä¸‹ä¸€é¡Œ
        function nextQuestion() {
            if (currentQuestionIndex < totalQuestions - 1) {
                currentQuestionIndex++;
                loadQuestion();
            } else {
                showResult();
            }
        }

        // é¡¯ç¤ºçµæœ
        function showResult() {
            document.getElementById('quiz-screen').classList.add('hidden');
            document.getElementById('result-screen').classList.remove('hidden');
            document.getElementById('result-screen').style.display = 'block'; // ç¢ºä¿é¡¯ç¤º

            const finalScoreEl = document.getElementById('final-score');
            const msgEl = document.getElementById('final-message');
            
            finalScoreEl.innerText = `${score} åˆ†`;

            if (score === 100) {
                msgEl.innerText = "å¤ªç¥äº†ï¼ä½ æ˜¯åå‰¯å…¶å¯¦çš„ç¥æ¢ç¦çˆ¾æ‘©æ–¯ï¼ğŸ•µï¸â€â™‚ï¸âœ¨";
            } else if (score >= 80) {
                msgEl.innerText = "å¹¹å¾—å¥½ï¼ä½ æ˜¯å‚‘å‡ºçš„è³‡æ·±è­¦æ¢ï¼ğŸš“";
            } else if (score >= 60) {
                msgEl.innerText = "é€šéè€ƒæ ¸ï¼ç¹¼çºŒç´¯ç©ç¶“é©—å§ï¼ğŸ“";
            } else {
                msgEl.innerText = "åˆ¥æ°£é¤’ï¼Œæ•¸å­¸åµæ¢éœ€è¦å¤šç·´ç¿’è¨ˆç®—å–”ï¼ğŸ’ª";
            }
        }
    </script>
</body>
</html>